# キーワード集
ランク別の重要キーワード集

## Sランク（知らないと何も始まらない）

### 1. Yocto Project

組み込み Linux を「**自分で組み立てるためのビルド仕組み**」の総称。
ディストリビューション（Ubuntu 的なもの）ではなく、**ディストリを作るための工場**。

* OS イメージ、rootfs、パッケージをビルドする仕組み一式
* 各社（Wind River, Mentor, etc）は Yocto をベースに自社ディストリを作ってる

---

### 2. Wind River Linux（WRLinux）

Wind River が Yocto をベースに作ってる **商用組み込み Linux ディストリ**。

* Yocto のレイヤ構造 + Wind River 独自のレイヤ（セキュリティ更新、LTS、サポートなど）
* 「OSを作る仕組み＋レシピ＋サポート」がセットになった製品

---

### 3. BitBake

Yocto のビルドシステム。雑に言うと「**超強化版 make みたいなもの**」。

* `bitbake <レシピ名>` でパッケージやイメージをビルド
* 並列ビルド、依存関係解決、タスク管理などを全部やる

---

### 4. Recipe（レシピ） / `.bb` / `.bbappend`

Yocto で一番よく見るファイル。

* `.bb`

  * パッケージやイメージをどうビルドするかを定義するファイル
  * ソースの取得方法（SRC_URI）・依存関係（DEPENDS）・ビルド手順（do_compile）・インストール手順（do_install）などを書く
* `.bbappend`

  * 既存の `.bb` を **後から拡張・修正する差分ファイル**
  * ベンダーが用意したレシピに自前のパッチを当てるときに多用

WRLinux のカスタマイズは、この `.bb` / `.bbappend` を弄るのがメイン。

---

### 5. Layer（レイヤ） / `meta-***`

レシピや設定をまとめた「**機能のまとまり**」。

* 例：

  * `meta`（基本レイヤ）
  * `meta-oe`（OpenEmbedded の追加レイヤ）
  * `meta-wrlinux`（Wind River のレイヤ）
  * `meta-custom`（自社・自分で追加するレイヤ）
* レイヤを重ねることで機能を積み上げる
* 上位レイヤが下位レイヤの設定を上書き可能（優先順位あり）

---

### 6. Machine（マシン） / `MACHINE`

ビルド対象のボードや SoC の定義。

* `MACHINE = "qemux86-64"` とか `MACHINE = "intel-x86-64"` みたいに指定
* CPU アーキテクチャ、デバイスツリー、U-Boot 設定などに関係
* WRLinux では `setup.sh --machines=<machine>` みたいに指定するやつ

---

### 7. Image（イメージ）

ビルド結果として生成される、「**OS の完成形**」のタイプ。

* 例：`wrlinux-image-glibc-small`, `core-image-minimal`, `core-image-full-cmdline` など
* どのパッケージが rootfs に入るかを定義
* `.bbappend` で `IMAGE_INSTALL:append = " foo bar"` みたいに追加していく

---

### 8. Root Filesystem（rootfs）

ターゲットで `/` にマウントされるファイルシステムの中身。
アプリ・ライブラリ・設定・スクリプト・systemd unit など全部ここ。

Yocto / WRLinux は
**「レシピ → パッケージ → rootfs → イメージ」** という流れで作る。

---

## Aランク（日常でガンガン出てくる）

### 9. `local.conf`

`build/conf/local.conf`

* ビルド環境ごとのローカル設定を書くファイル
* 例：

  * `MACHINE` の指定
  * `BB_NUMBER_THREADS`, `PARALLEL_MAKE`（並列数）
  * デバッグ/最適化フラグ
* 触りすぎるとビルド地獄になるので、**本当に必要な設定だけ**書くのが吉

---

### 10. `bblayers.conf`

`build/conf/bblayers.conf`

* どのレイヤを使うか定義する
* 新しい `meta-custom` レイヤを追加したら、ここにパスを追記する

---

### 11. Task（do_compile / do_install / do_rootfs など）

レシピ内で実行される「タスク」の単位。

* よく見るやつ：

  * `do_fetch`：ソース取得
  * `do_unpack`：展開
  * `do_patch`：パッチ当て
  * `do_configure`：設定
  * `do_compile`：ビルド
  * `do_install`：sysroot へのインストール
  * `do_rootfs`：rootfs の構築
* `bitbake -c <task> <recipe>` の形で個別実行もできる
  例：`bitbake -c clean mydrv`

---

### 12. `SSTATE` / `sstate-cache`

再ビルドを高速化するためのキャッシュ。

* タスク単位のビルド結果（中間生成物）をキャッシュ
* 同じ設定・同じソースなら再利用
* 複数開発者で共有するとビルド時間が爆縮する

---

### 13. `DL_DIR`

ソースコードをダウンロードしてキャッシュするディレクトリ。

* 社内で共有すると、`git fetch` や `wget` の無駄が減る
* オフライン環境でのビルドにも関わる（事前ダウンロード）

---

### 14. DISTRO / `DISTRO_FEATURES`

ディストリビューションとしての設定。

* 例：`DISTRO = "wrlinux"`
* `DISTRO_FEATURES` は「このディストロで有効化する機能一覧」

  * `x11`, `systemd`, `ipv6`, `alsa`, `bluetooth` など

---

### 15. PACKAGECONFIG

個々のレシピに対する「ビルドオプション」の集合。

* `PACKAGECONFIG` をいじることで機能の ON/OFF を制御
* 例：

  * `PACKAGECONFIG[ssl] = "--with-ssl,--without-ssl,openssl"`
* ある機能だけ削りたい・追加したいときに触る

---

### 16. sysroot

クロスコンパイル時に参照する「ターゲット側のヘッダ・ライブラリ環境」。

* 開発用ホストにはインストールされていない glibc, libstdc++, ドライバヘッダなどをここに持つ
* Yocto がレシピごとに sysroot をいい感じに管理してくれる

---

## Bランク（カーネル・ブート関連で重要）

### 17. virtual/kernel

Yocto で「カーネル」を抽象化した名前。

* 実際には `linux-windriver` とか `linux-yocto` などの実体がある
* `PREFERRED_PROVIDER_virtual/kernel` でどのカーネルを使うか選ぶ

---

### 18. Device Tree（DTS / DTC / DTB）

ARM 系 SoC などでハード構成を記述する仕組み。

* `.dts` / `.dtsi`：ソース
* `dtc`：コンパイラ
* `.dtb`：バイナリ
* I2C / SPI / GPIO / 割り込みラインなどの情報をここに書く
  → ドライバが `compatible` を見てデバイスをバインド

---

### 19. BSP（Board Support Package）

特定のボード / SoC 用のサポートパッケージ一式。

* カーネル設定、デバイスツリー、ブートローダ、マシン設定など
* WRLinux では、ベンダー or Wind River が BSP を提供
  → 自前ボードだとここを改造・拡張する羽目になる

---

### 20. U-Boot

組み込み Linux でよく使われるブートローダ。

* ROM から最初に起動して、カーネルをロードする役割
* Yocto/WRLinux では、U-Boot 自体もレシピでビルド・設定される

---

## Cランク（WRLinux固有・商用ならでは）

### 21. LTS（Long Term Support）

長期サポート版。

* WRLinux は特定バージョンに対して数年間のセキュリティ修正・バグ修正を提供
* 製品のライフサイクル（5〜10年）に合わせたサポートを受けられるのが売り

---

### 22. CVE / セキュリティフィード

CVE（脆弱性情報）と、その対策パッチ。

* WRLinux は CVE 対応パッチを取り込んだレイヤや更新を提供
* 「どのイメージにどの修正が入っているか」をトレースしやすい

---

### 23. WR Workbench / Wind River IDE

Wind River が提供している Eclipse ベースの IDE / 開発環境。

* カーネルデバッグ、ターゲットへのリモート接続、トレースなどが GUI でできる
* 現場によっては使わず CLI / ssh だけ、というところもある

---

## Dランク（わかってるとだいぶ楽になるやつ）

### 24. PREFERRED_PROVIDER / PREFERRED_VERSION

「どの実装 / どのバージョンを使うか」を選ぶための変数。

* `PREFERRED_PROVIDER_virtual/kernel = "linux-windriver"`
* `PREFERRED_VERSION_linux-windriver = "5.10%"` みたいに指定

---

### 25. bbclass（クラス） / `inherit`

レシピの共通処理を切り出したもの。

* `inherit autotools`
* `inherit cmake`
* `inherit module`
* `inherit systemd`
  など

共通インフラを持たせることで、レシピを短く保つ。

---

### 26. IMAGE_INSTALL / CORE_IMAGE_EXTRA_INSTALL

イメージに入れるパッケージリスト。

* `IMAGE_INSTALL`：そのイメージが標準で持つパッケージ
* `IMAGE_INSTALL:append = " foo bar"` のように追記するのが定番
* `CORE_IMAGE_EXTRA_INSTALL` を使うパターンもある（ディストロやポリシー次第）

---

### 27. multilib

1つのシステムで複数の ABI（例：32bit / 64bit）を共存させる仕組み。

* x86_64 に 32bit ライブラリだけ追加したい、みたいなときに使う
* 組み込みではあまり多用しないが、知識としては知っておくとよい

---

## ここまでの整理と、今のボトルネック

今のボトルネックは多分これ：

> 用語の数が多すぎて、**「結局なにが核なのか」**が分かりづらい状態

だけど、現実に重要なのはかなり絞れる：

* ビルドまわり
  → BitBake / Recipe / Layer / local.conf / bblayers.conf / sstate
* ターゲットまわり
  → Image / rootfs / virtual/kernel / DeviceTree / Machine
* カスタマイズ
  → `.bbappend` / IMAGE_INSTALL / module レシピ / systemd

この辺りだけしっかり押さえれば、
他の用語は「必要になったときに調べる」で十分。
