== 第7章: 規格準拠と認証支援
WRLは多様な産業規格に対応するための機能とドキュメントを提供します。本章では、医療、車載、通信などの規格を想定した準拠活動と、Wind Riverの支援リソースをまとめます。

=== 代表的な規格と対応ポイント
[%autowidth,options="header"]
|===
|規格|対象分野|WRLでの対応例|留意事項
|IEC 62304|医療機器ソフトウェア|品質管理手順、リスクマネジメントテンプレート|ソフトウェア分類(クラスA/B/C)によって検証強度が異なる
|ISO 26262|車載機能安全|ASIL対応のソフトウェア開発プロセス、ツール分類|安全ケース作成とトレーサビリティ確保が必須
|DO-178C|航空機|開発計画書テンプレート、ソース管理の監査証跡|レベルA〜Eでエビデンス量が変動
|ETSI NFV/3GPP|通信|キャリアグレードレイヤ(`meta-cgl`)、HAクラスタ構成|継続的なパフォーマンス評価が必要
|===

[NOTE]
====
規格準拠ではドキュメント整備が最も時間を要します。WRLでは`Wind River Helix Virtual Labs`などのオンラインリソースでテンプレートが提供されるため、初期段階から活用すると効率的です。
====

=== トレーサビリティと構成管理
* *要件管理*: PolarionやJamaと連携し、ソフトウェア要件からレシピ/レイヤへのトレースを維持。
* *構成識別*: `manifest`ファイルやGitタグでビルド構成を固定し、認証提出時に再現性を確保。
* *監査ログ*: `auditd`や`git log --decorate`を用いて変更履歴を明確化。

=== ドキュメント化のベストプラクティス
規格準拠に必要なドキュメント例を示します。

[%autowidth,options="header"]
|===
|ドキュメント|内容|作成タイミング
|ソフトウェア開発計画(SDP)|開発手順、役割分担、レビュー体制|プロジェクト開始時
|構成管理計画(SCMP)|構成要素の識別、変更管理|環境構築完了時
|検証計画/報告|テストケース、結果、証拠|各リリースサイクル
|問題報告・解決記録|不具合の分類、是正処置|随時
|===

Wind Riverは`Quality Management System(QMS)`に基づくテンプレートを提供しており、必要に応じてProfessional Servicesがドキュメント作成を支援します。

=== オープンソースライセンス遵守
WRLではOSSライセンスの管理も重要です。

* `wrl-sbom`で生成したSPDXを活用し、ライセンス義務(通知、ソース提供)を整理。
* `meta-spdxscanner`レイヤを追加して自動スキャンを実施。
* 顧客提供用に`LICENSE.manifest`を生成し、配布物に同梱。

[source,bash]
----
bitbake wrlinux-image-glibc-std -c populate_lic
ls tmp/deploy/images/<machine>/*manifest*
----

=== 監査対応の準備
* *内部監査*: 四半期ごとにプロセス遵守状況をレビューし、是正計画を策定。
* *外部監査*: 認証機関の監査前にモック監査を実施し、質問リストと回答例を準備。
* *証跡保管*: ビルドログ、テスト結果、レビュー記録をバージョン管理し、保管期間を定める。

=== チェックリスト
* [ ] 対象規格の要求事項が要件管理ツールに登録されている。
* [ ] 重要ドキュメントのテンプレートと作成責任者が決まっている。
* [ ] SBOMとライセンスマニフェストが顧客提供用に整備されている。
* [ ] 監査時に提示する証跡(ビルドログ、テスト結果)の保管場所が明確である。
* [ ] 規格アップデートに合わせてプロセスを見直すスケジュールが設定されている。

=== より高度な準拠活動

==== モデルベース開発との統合
ISO 26262やDO-178Cでは、モデルベース開発(MBD)ツールとの連携が要求されるケースがあります。WRL上で実行する制御アプリケーションがSimulinkやSCADEで生成される場合、以下の手順を確立します。

1. MBDツールの生成コードからレシピを自動生成するスクリプトを用意し、`devtool`でテンプレート化。
2. 生成ソースのバージョンとモデルファイルのハッシュを`manifest`に追記し、トレーサビリティを確保。
3. モデルレベルのテスト結果をテスト管理ツール(TestRailなど)からエクスポートし、システムテスト結果と紐付け。

==== 品質メトリクスの可視化
規格監査では、欠陥密度、テスト網羅率、コードレビュー実施率などの定量指標が求められます。`sonarqube`, `lcov`, `pytest --cov`の結果をCIで収集し、ダッシュボード(Grafana, Power BI)で可視化します。Wind RiverのProfessional Servicesが提供する`Compliance Dashboard`を活用すると、規格要件に紐づくメトリクス管理が容易になります。

==== 文書の翻訳とローカライズ
海外監査では英語版ドキュメントが求められるため、AsciiDocを多言語対応する仕組みを用意します。`asciidoctor`の属性を利用して、言語ごとのメタデータや用語集を切り替えます。

[source,bash]
----
asciidoctor -a lang=ja docs/compliance.adoc
asciidoctor -a lang=en docs/compliance.adoc
----

共通のグロッサリを`includes/glossary.adoc`にまとめ、専門用語の訳語を統一すると監査対応がスムーズになります。

==== サプライチェーンリスク管理
WRLベースの製品に組み込むサードパーティソフトウェアやサービスについても、契約・ライセンス条件を整理します。

* ソフトウェア部品ごとにSLA(サービスレベル合意)とサポート期限を一覧化。
* 依存するクラウドサービス(AWS IoT, Azure IoTなど)のデータ所在地やコンプライアンス認証(SOC 2, ISO 27001)を確認。
* サプライチェーン全体での脆弱性報告フローを明確化し、影響評価テンプレートを共有。

==== 模擬監査の実施
内部監査チームが第三者の視点で模擬監査を行い、ギャップ分析レポートを発行します。Wind Riverの認証支援サービスを利用すると、実際の審査官経験を持つコンサルタントからフィードバックを得られます。
